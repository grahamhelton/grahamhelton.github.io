![](./images/images/kubenomicon_cropped.png)


# Check out The Kubenomicon
- [The Kubenomicon](https://kubenomicon.com)

# What is The Kubenomicon?
The Kubenomicon was born of a desire to understand more about Kubernetes from an offensive perspective. I found many great resources to aid in my journey, but I quickly realized:
1. I will never be able to solely document every offensive and defensive Kubernetes technique on my own.
2. Things in the Kubernetes world [move really fast](https://kubernetes.io/releases/release/) and there are constantly new attack surfaces to explore. 
My solution to this is to start the Kubenomicon -- a place where offensive security techniques and how to defend against them can easily be documented via pull requests to the Kubenomicon GitHub. 

This project was heavily inspired by the [Kubernetes Threat Matrix](https://microsoft.github.io/Threat-Matrix-for-Kubernetes/) from Microsoft which is a great starting point as it provides a framework to help understand some of the concepts in a [MITRE ATTACK](https://attack.mitre.org/) style framework. The Microsoft Threat Matrix was explicitly not designed to be a playbook offensive for security professionals and thus it lacks the details necessary to actually exploit (and remediate) each attack in Kubernetes cluster. 

# The Kubenomicon Threat Matrix

| [Initial Access](Initial_access.md)                                                            | [Execution](Execution.md)                                       | [Persistence](Persistence.md)                                                     | [Privilege Escalation](Privilege_escalation.md)                            | [Defense Evasion](Defense_evasion.md)                                       | [Credential Access](Credential_access.md)                                                                               | [Discovery](Discovery.md)                                                   | [Lateral Movement](Lateral_movement.md)                                                                                | [Collection](Collection.md)                                                      | [Impact](Impact.md)                                  |
| ---------------------------------------------------------------------------------------------- | --------------------------------------------------------------- | --------------------------------------------------------------------------------- | -------------------------------------------------------------------------- | --------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------- | ---------------------------------------------------- |
| [Using Cloud Credentials](./Initial_access/Using_cloud_credentials.md)                         | [Exec inside container](./Execution/Exec_inside_container.md)   | [Backdoor Container](./Persistence/Backdoor_container.md)                         | [Privileged Container](./Privilege_escalation/Privileged_container.md)     | [Clear Container Logs](./Defense_evasion/Clear_container_logs.md)           | [List K8S secrets](./Credential_access/List_K8S_secrets.md)                                                             | [Access Kubernetes API Server](./Discovery/Access_kubernetes_API_server.md) | [Access Cloud Resources](./Lateral_movement/Access_cloud_resources.md)                                                 | [Images from a private registry](./Collection/Images_from_a_private_registry.md) | [Data Destruction](./Impact/Data_destruction.md)     |
| [Compromised image in registry](./Initial_access/Compromised_image_in_registry.md)             | [New Container](./Execution/New_container.md)                   | [Writable hostPath mount](./Persistence/Writable_hostPath_mount.md)               | [Cluster-admin binding](./Privilege_escalation/Cluster-admin_binding.md)   | [Delete Events](./Defense_evasion/Delete_events.md)                         | [Access Node Information](./Credential_access/Access_node_information.md)                                               | [Access Kubelet API](./Discovery/Access_kubelet_API.md)                     | [Container Service Account](./Lateral_movement/Container_service_account.md)                                           | [Collecting Data From Pod](./Collection/Collecting_data_from_pod.md)             | [Resource Hijacking](./Impact/Resource_hijacking.md) |
| [Kubeconfig File](./Initial_access/Kubeconfig_file.md)                                         | [Application Exploit (RCE)](./Execution/Application_exploit.md) | [Kubernetes Cronjob](./Persistence/Kubernetes_cronjob.md)                         | [hostPath Mount](./Privilege_escalation/hostPath_mount.md)                 | [Pod Name Similarity](./Defense_evasion/Pod_name_similarity.md)             | [Container Service Account](./Credential_access/Container_service_account.md)                                           | [Network Mapping](./Discovery/Network_mapping.md)                           | [Cluster Internal Networking](./Lateral_movement/Cluster_internal_networking.md)                                       |                                                                                  | [Denial of Service](./Impact/Denial_of_service.md)   |
| [Application Vulnerability](./Initial_access/Application_vulnerability.md)                     | [Sidecar Injection](./Execution/Sidecar_injection.md)           | [Malicious Admission Controller](./Persistence/Malicious_admission_controller.md) | [Access Cloud Resources](./Privilege_escalation/Access_cloud_resources.md) | [Connect From Proxy Server](./Defense_evasion/Connect_from_proxy_server.md) | [Application Credentials In Configuration Files](./Credential_access/Application_credentials_in_configuration_files.md) | [Exposed Sensitive Interfaces](./Discovery/Exposed_sensitive_interfaces.md) | [Application Credentials In Configuration Files](./Lateral_movement/Application_credentials_in_configuration_files.md) |                                                                                  |                                                      |
| [Exposed Sensitive Interfaces](./Initial_access/Exposed_sensitive_interfaces.md)               |                                                                 | [Container Service Account](./Persistence/Container_service_account.md)           |                                                                            |                                                                             | [Access Managed Identity Credentials](./Credential_access/Access_managed_identity_credentials.md)                       | [Instance Metadata API](./Discovery/Instance_metadata_API.md)               | [Writable hostpath Mount](./Lateral_movement/Writable_hostPath_mount.md)                                               |                                                                                  |                                                      |
| [SSH server running inside container](./Initial_access/SSH_server_running_inside_container.md) |                                                                 | [Static Pods](./Persistence/Static_pods.md)                                       |                                                                            |                                                                             | [Malicious Admission Controller](./Credential_access/Malicious_admission_controller.md)                                 |                                                                             | [CoreDNS Poisoning](./Lateral_movement/CoreDNS_poisoning.md)                                                           |                                                                                  |                                                      |
|                                                                                                |                                                                 |                                                                                   |                                                                            |                                                                             |                                                                                                                         |                                                                             | [ARP Poisoning and IP Spoofing](./Lateral_movement/ARP_poisoning_and_IP_spoofing.md)                                   |                                                                                  |                                                      |


# Prior work
I am far from the first person to come up with the idea to document this information. Many great projects exist that take a similar approach to this. Most notably what inspired this project was the [Microsoft Kubernetes Threat Matrix](https://microsoft.github.io/Threat-Matrix-for-Kubernetes/). Additionally, late into putting this project together I discovered this amazing [Threat matrix from RedGuard](https://kubernetes-threat-matrix.redguard.ch/). Some other projects that served as inspiration for this include:
- [Kubernetes Hacktricks](https://cloud.hacktricks.xyz/pentesting-cloud/kubernetes-security)
